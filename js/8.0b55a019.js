(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"14c8":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"flex flex-center relative-position"},[n("transition",{attrs:{appear:"",mode:"out-in","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[e.loading?e._e():n("div",[n("card-status",{attrs:{loyalty:!!e.loyalty.length}}),!e.loyalty.length||e.$q.platform.is.ios?n("div",{staticClass:"absolute absolute-bottom row justify-center q-px-md",staticStyle:{bottom:"34px"}},[n("q-btn",{staticClass:"full-width text-weight-bold elevation-0 mp-btn mp-btn__white",attrs:{href:e.bookingLink,type:"a",target:"_blank",color:"white","text-color":"dark",padding:"16px",label:"Перейти на Booking","no-caps":""},on:{click:function(t){return e.callEvent("services_booking_"+(e.customerId?"trueid":"falceid"))}}})],1):e._e()],1)]),n("a",{ref:"linkRef",staticStyle:{display:"none"},attrs:{href:e.bookingLink,target:"_blank"}})],1)},l=[],i=n("e4fd"),a=n("0854"),s=n("ef77"),c=n("79f6"),r=n("0967"),u=function(e,t,n,o){function l(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(t){i(t)}}function s(e){try{c(o["throw"](e))}catch(t){i(t)}}function c(e){e.done?n(e.value):l(e.value).then(a,s)}c((o=o.apply(e,t||[])).next())}))};const{amplitudeClickEvent:d}=Object(a["a"])();var b=Object(i["defineComponent"])({name:"BookingProxyPage",props:{test:{type:String,default:null}},meta:{title:"Booking"},components:{"card-status":()=>Promise.all([n.e(0),n.e(19)]).then(n.bind(null,"56ca")),"lottie-player":()=>Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"9e35"))},setup({test:e}){const t=Object(i["ref"])(!0),n=Object(i["ref"])(""),o=Object(i["ref"])([]),l=Object(i["ref"])(!1),a=Object(i["ref"])("https://sp.booking.com/?aid=2115954&label=MP"),b=e=>{var t;l.value||(d(e,{tel:p,loyalty:null===(t=o.value[0])||void 0===t?void 0:t.card_number}),l.value=!0)},f=Object(i["ref"])({click:()=>!0}),v=e=>{var t;b(`services_booking_${e}`),r["b"].is.ios||(null===(t=f.value)||void 0===t||t.click(),Object(s["f"])("dismiss"))},{customerPhone:p}=Object(s["d"])();Object(i["watch"])(p,((e,t)=>{e&&t!==e&&m()}));const m=()=>u(this,void 0,void 0,(function*(){yield Object(c["c"])(p.value).then((e=>{r["b"].is.ios&&console.log("Ответ от бекенда с картами лояльности:",e),e&&(o.value=e)})),Object(s["f"])("requestAmplitudeId"),h()})),{setData:g}=Object(s["b"])(n),k=e=>{g(e),r["b"].is.ios&&console.log("Получен id пользователя:",n.value),a.value=`https://sp.booking.com/?aid=2115954&label=${n.value}`,Object(s["e"])(),t.value=!1,setTimeout((()=>{o.value.length&&v("trueid")}),5e3)};Object(s["a"])("dev_setAmlitudeId",k);const h=()=>{setTimeout((()=>{n.value||(t.value=!1,Object(s["e"])(),r["b"].is.ios&&console.log("таймаут запроса id пользователя"),v("falseid"))}),7500)},y=()=>{setTimeout((()=>{p.value||(r["b"].is.ios&&console.log("таймаут запроса номера телефона пользователя"),Object(s["f"])("requestAmplitudeId"),h())}),7500)};return Object(s["h"])(),y(),{loading:t,linkRef:f,customerId:n,bookingLink:a,linkEmit:v,loyalty:o}}}),f=b,v=n("2877"),p=n("9989"),m=n("9c40"),g=n("eebe"),k=n.n(g),h=Object(v["a"])(f,o,l,!1,null,null,null);t["default"]=h.exports;k()(h,"components",{QPage:p["a"],QBtn:m["a"]})}}]);