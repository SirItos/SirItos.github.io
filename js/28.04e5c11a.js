(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[28],{"65b3":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:" bg-white br-10"},[a("div",{staticClass:"q-pa-md row items-center"},[a("div",{staticClass:"col"},[a("span",{staticClass:"text-weight-bold",class:{"text-grey-5":e.unlimited}},[e._v("Водители")])]),a("div",[a("q-checkbox",{staticClass:"q-mr-md",attrs:{value:e.unlimited,label:"Неограниченное кол-во"},on:{input:function(t){return e.changeState(t)}}}),a("q-btn",{attrs:{disable:e.unlimited,color:e.unlimited?"grey-4":"primary",unelevated:"",icon:"add",label:"Добавить","no-caps":""},on:{click:e.addDriver}})],1)]),a("q-separator"),a("q-slide-transition",[e.unlimited?e._e():a("div",{staticClass:"q-pa-md"},[e.drivers.length?a("div",[a("q-table",{attrs:{data:e.drivers,columns:e.columns,flat:"",dence:"","row-key":"name","hide-bottom":""},scopedSlots:e._u([{key:"header",fn:function(t){return[a("q-tr",{attrs:{props:t}},[e._l(t.cols,(function(r){return a("q-th",{key:r.name,attrs:{props:t}},[e._v("\n                "+e._s(r.label)+"\n              ")])})),a("q-th")],2)]}},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{key:"fio",staticClass:"text-center",attrs:{props:t}},[e._v("\n                "+e._s(t.row.last_name.value)+"\n                "+e._s(t.row.first_name.value)+"\n                "+e._s(t.row.patronymic.value)+"\n              ")]),a("q-td",{key:"docs",staticClass:"text-center",attrs:{props:t}},[e._v("\n                "+e._s(t.row.driver_license.value)+"\n              ")]),a("q-td",{key:"exp",staticClass:"text-center",attrs:{props:t}},[e._v("\n                "+e._s(e.convertToYear(t.row.driving_since.value))+"\n              ")]),a("q-td",{key:"birthDate",staticClass:"text-center",attrs:{props:t}},[e._v("\n                "+e._s(t.row.birthdate.value)+"\n              ")]),a("q-td",[a("div",{staticClass:"q-gutter-x-md"},[a("q-btn",{attrs:{color:"primary",flat:"",icon:"edit",round:""},on:{click:function(a){return e.editDriver(t.row,t.rowIndex)}}}),a("q-btn",{attrs:{color:"primary",flat:"",icon:"delete",round:""},on:{click:function(a){return e.deleteDriver(t.rowIndex)}}})],1)])],1)]}}],null,!1,747678069)})],1):a("div",{staticClass:"row items-center justify-center"},[e._v("\n        --- Нет водителей ---\n      ")])])])],1)},i=[],l=a("e4fd"),n=a("436b"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{ref:"dialog",on:{hide:e.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin"},[a("q-card-section",{staticClass:"text-weight-bold text-h6"},[e._v(e._s(e.title)+"\n    ")]),a("q-form",{ref:"dialogForm",staticClass:"q-gutter-md row"},[a("div",{staticClass:"row q-col-gutter-sm q-px-md q-mb-md"},e._l(e.dialogDriver,(function(t,r){return a("div",{key:"driver_fields_"+r,staticClass:"col-6"},["text"===t.type?a("q-input",{attrs:{rules:t.required?t.aditionalRules?t.aditionalRules:[function(t){return e.emptyRule(t)}]:[],label:t.label,mask:t.mask,hint:t.hint,"lazy-rules":"","no-error-icon":""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}}):e._e(),"select"===t.type?a("q-select",{staticStyle:{"margin-bottom":"20px"},attrs:{options:t.options,"option-label":t.optionLabel,"option-value":t.optionValue,"emit-value":"","map-options":"",label:t.label,"no-error-icon":""},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}}):e._e(),"date"===t.type?a("q-input",{attrs:{label:t.label,rules:t.required?t.aditionalRules?t.aditionalRules:[function(t){return e.emptyRule(t)}]:[],mask:t.dateMask?"####":"##.##.####","no-error-icon":""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy_"+r,refInFor:!0,attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{minimal:"",mask:t.dateMask?"YYYY":"DD.MM.YYYY","default-view":t.dateMask?"Years":"Calendar","emit-immediately":!!t.dateMask,options:t.optionsFn},on:{input:function(t){return e.hideProxy(r)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{"no-caps":"",label:"Ок",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!0),model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"field.value"}}):e._e()],1)})),0)]),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",flat:"","no-caps":"",label:"Отмена"},on:{click:e.onCancelClick}}),a("q-btn",{attrs:{color:"primary",unelevated:"","no-caps":"",label:"Сохранить"},on:{click:e.onOKClick}})],1)],1)],1)},s=[],d=a("ded3"),c=a.n(d),u=a("bd4c"),p=a("a20a");const{emptyRule:m,emailRules:v,lengthRule:b}=Object(p["b"])();var f={props:{driver:{type:Object,default:()=>({})},title:{type:String,default:"Добавить водителя"},index:{type:[Number,String],default:"new"}},components:{},data:()=>({dialogDriver:{last_name:{label:"Фамилия",value:"",type:"text",required:!0},first_name:{label:"Имя",value:"",type:"text",required:!0},patronymic:{label:"Отчетсво",value:"",type:"text",required:!1},birthdate:{label:"Дата рождения ",value:"",type:"date",optionsFn:e=>{const t=u["b"].formatDate(u["b"].subtractFromDate(Date.now(),{year:"18"}),"YYYY/MM/DD");return e<=t},aditionalRules:[e=>m(e),e=>b(e,10),e=>{if(e.length<10)return!0;const t=u["b"].formatDate(u["b"].subtractFromDate(Date.now(),{year:"18"}),"YYYY/MM/DD"),a=e.split("."),r=a[2]+"/"+a[1]+"/"+a[0];return console.log(u["b"].formatDate(r,"X")),console.log(u["b"].formatDate(t,"X")),!(Number(u["b"].formatDate(r,"X"))>=Number(u["b"].formatDate(t,"X")))||"Водитель должен быть совершеннолетний"}],required:!0},gender:{label:"Пол",value:1,type:"select",options:[{id:1,label:"Муж"},{id:2,label:"Жен"}],optionLabel:"label",optionValue:"id",required:!0},driver_license:{label:"В/У",value:"",type:"text",required:!0},driving_since:{label:" Стаж",value:"",type:"date",dateMask:"YYYY",imid:!0,aditionalRules:[e=>m(e)],required:!0},date_issue:{label:"Дата выдачи В/У",value:"",type:"date",required:!0}},emptyRule:m,emailRules:v}),mounted(){var e;null!==(e=this.driver)&&void 0!==e&&e.first_name&&Object.keys(this.driver).forEach((e=>{let t=this.driver[e].value;"driving_since"===e&&(t=Object(p["a"])(this.driver[e].value)),this.dialogDriver[e].value=t}))},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(){this.$refs.dialogForm.validate().then((e=>{e&&(this.$emit("ok",c()({},this.dialogDriver)),this.hide())}))},hideProxy(e){this.$refs[`qDateProxy_${e}`][0].hide()},onCancelClick(){this.hide()}}},h=f,y=a("2877"),q=a("24e8"),g=a("f09f"),_=a("a370"),k=a("0378"),x=a("27f9"),D=a("ddd8"),C=a("0016"),w=a("7cbe"),Y=a("52ee"),Q=a("9c40"),$=a("4b7e"),O=a("7f67"),R=a("eebe"),j=a.n(R),M=Object(y["a"])(h,o,s,!1,null,null,null),S=M.exports;j()(M,"components",{QDialog:q["a"],QCard:g["a"],QCardSection:_["a"],QForm:k["a"],QInput:x["a"],QSelect:D["a"],QIcon:C["a"],QPopupProxy:w["a"],QDate:Y["a"],QBtn:Q["a"],QCardActions:$["a"]}),j()(M,"directives",{ClosePopup:O["a"]});const F=()=>{const e=[{name:"fio",label:"ФИО",sortable:!1,align:"middle"},{name:"docs",label:"В/У",sortable:!1,align:"middle"},{name:"exp",label:"Стаж",sortable:!1,align:"middle"},{name:"birthDate",label:"Дата рождения",sortable:!1,align:"middle"}];return{columns:e}};var P=Object(l["defineComponent"])({name:"DriverComponents",props:{drivers:{type:Array,required:!0},unlimited:{type:Boolean,required:!0}},setup({drivers:e},{root:t,emit:a}){const r=e=>{a("setUnlimited",e)};e.length||r(!0);const i=()=>{n["a"].create({component:S}).onOk((t=>{e.push(t)})).onDismiss((()=>{}))},l=(a,r)=>{n["a"].create({component:S,driver:Object.assign({},a),title:`${a.last_name.value} ${a.first_name.value} ${a.patronymic.value}`,index:r}).onOk((a=>{t.$set(e,r,a)}))},o=t=>{n["a"].create({title:"Удалить водителя",index:t,confirm:!0,ok:{"no-caps":!0,lable:"Да"},cancel:{"no-caps":!0,lable:"нет"}}).onOk((()=>{e.splice(t,1)}))};return Object.assign({addDriver:i,editDriver:l,deleteDriver:o,changeState:r,convertToYear:p["a"]},F())}}),T=P,I=a("8f8e"),N=a("eb85"),X=a("e9c1"),B=a("eaac"),E=a("bd08"),A=a("357e"),H=a("db86"),J=Object(y["a"])(T,r,i,!1,null,null,null);t["default"]=J.exports;j()(J,"components",{QCheckbox:I["a"],QBtn:Q["a"],QSeparator:N["a"],QSlideTransition:X["a"],QTable:B["a"],QTr:E["a"],QTh:A["a"],QTd:H["a"]})}}]);